# FileUploader 文件上传组件设计说明

## 概述

FileUploader 组件负责处理 HearSight 应用中的本地文件上传功能，支持视频和音频文件的拖拽上传和选择上传。该组件是用户上传本地媒体文件的核心交互模块。

## 组件结构

### FileUploader.tsx

主容器组件，负责：

- 文件选择和拖拽上传
- 文件类型验证
- 文件上传过程管理
- 上传结果处理

### 核心功能模块

- **文件选择**: 支持点击选择文件上传
- **拖拽上传**: 支持拖拽文件到指定区域上传
- **文件验证**: 验证文件类型是否为支持的音视频格式
- **上传管理**: 管理上传过程和状态

## 设计原则

### 1. 用户友好
- 提供直观的上传界面
- 支持多种上传方式（拖拽、点击）
- 显示上传进度和状态
- 提供清晰的操作反馈

### 2. 文件类型支持
- 支持常见视频格式（mp4, avi, mov, mkv等）
- 支持常见音频格式（mp3, wav, m4a, aac等）
- 自动识别文件类型并验证

### 3. 状态管理
- 管理文件选择状态
- 管理上传过程状态
- 处理上传结果回调

## 功能详解

### 文件选择

- 点击上传区域选择文件
- 支持单个文件选择
- 自动验证文件类型
- 不支持的文件格式会显示错误提示

### 拖拽上传

- 支持将文件拖拽到上传区域
- 拖拽过程中有视觉反馈
- 放下文件后自动开始处理
- 同样进行文件类型验证

### 文件验证

- 检查文件扩展名是否为支持的音视频格式
- 视频格式包括：mp4, avi, mov, mkv, flv, wmv, webm
- 音频格式包括：mp3, wav, m4a, aac, flac, ogg, wma
- 不支持的格式会拒绝上传并提示用户

### 上传管理

- 显示上传进度条
- 显示上传过程中的加载状态
- 上传完成后触发成功回调
- 上传失败时触发错误回调

## 数据流设计

### Props 接口

- onUploadSuccess: 上传成功回调
- onUploadError: 上传错误回调

### 内部状态

- file: 当前选择的文件
- uploading: 上传状态
- dragActive: 拖拽状态

### 上传结果数据结构

- static_url: 文件访问URL
- is_audio: 是否为音频文件
- placeholder_url: 占位图片URL（可选）
- job_id: 任务ID（可选）

## 用户交互设计

### 上传区域

- 显示上传提示文字和图标
- 支持点击和拖拽两种交互方式
- 拖拽时有视觉状态变化

### 文件信息展示

- 显示已选择文件的名称
- 显示文件大小
- 提供取消选择功能

### 操作按钮

- **选择文件按钮**: 点击选择文件
- **取消按钮**: 取消已选择的文件
- **上传按钮**: 开始上传文件

## 无障碍设计

### 键盘导航
- 支持 Tab 键在元素间导航
- 支持 Enter 键激活按钮
- 支持 Space 键激活文件选择

### 屏幕阅读器支持
- 提供适当的 ARIA 标签
- 为操作按钮添加描述性文本
- 确保界面元素语义化