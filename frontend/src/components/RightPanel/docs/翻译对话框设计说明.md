# TranslateDialog 翻译对话框设计说明

## 概述

TranslateDialog 组件负责处理 HearSight 应用中的文本翻译功能，提供语言检测、翻译选项和翻译过程管理。该组件是多语言支持功能的核心交互模块，帮助用户将转写内容翻译为目标语言。

## 组件结构

### TranslateDialog.tsx

主容器组件，负责：

- 语言检测和推荐
- 翻译选项的选择和配置
- 翻译过程的启动和管理
- 用户交互事件的处理

### 核心功能模块

- **语言检测**: 自动检测原文语言并推荐目标语言
- **翻译选项**: 提供常用语言选择和翻译控制
- **翻译过程**: 管理翻译任务的启动和状态
- **用户确认**: 支持强制重新翻译选项

## 设计原则

### 1. 智能化
- 自动检测原文语言
- 智能推荐目标语言
- 提供翻译质量保障

### 2. 用户友好
- 简洁直观的操作界面
- 清晰的状态反馈
- 灵活的翻译控制选项

### 3. 可靠性
- 处理翻译过程中的错误
- 提供翻译进度反馈
- 支持翻译任务取消

## 功能详解

### 语言检测

- 组件打开时自动检测原文语言
- 使用内置语言检测算法分析文本
- 根据检测结果推荐目标语言
- 显示检测过程中的加载状态

### 语言选择

- 提供常用语言选项（中文、英文等）
- 显示语言的详细名称
- 支持手动选择目标语言
- 保存用户选择偏好

### 翻译控制

- 支持强制重新翻译选项
- 检测已有翻译内容并提示用户
- 提供翻译过程中的状态反馈
- 支持翻译任务取消操作

### 用户确认

- 检测到已有翻译时提示用户确认
- 提供继续翻译或强制重新翻译选项
- 确认后启动翻译任务

## 数据流设计

### Props 接口

- open: 对话框打开状态
- onOpenChange: 对话框状态变更回调
- transcriptId: 转写ID
- segments: 转写片段数据
- onStartTranslate: 启动翻译回调
- isTranslating: 翻译进行中状态

### 内部状态

- step: 当前步骤（检测中、选择中）
- detection: 语言检测结果
- targetLanguage: 目标语言
- loading: 加载状态
- error: 错误信息
- forceRetranslate: 强制重新翻译状态

### 语言选项数据结构

- code: 语言代码
- name: 语言名称

## 用户交互设计

### 对话框流程

- **第一步**: 语言检测阶段，显示检测进度
- **第二步**: 语言选择阶段，展示推荐语言和选项
- **操作按钮**: 提供取消和确认按钮

### 语言选项

- 使用下拉选择器展示语言选项
- 显示语言的完整名称
- 支持快速选择常用语言

### 强制翻译选项

- 提供开关选项控制是否强制重新翻译
- 检测到已有翻译时默认启用确认

## 无障碍设计

### 键盘导航
- 支持 Tab 键在元素间导航
- 支持 Enter 键确认操作
- 支持 Escape 键关闭对话框

### 屏幕阅读器支持
- 提供适当的 ARIA 标签
- 为操作元素添加描述性文本
- 确保界面元素语义化