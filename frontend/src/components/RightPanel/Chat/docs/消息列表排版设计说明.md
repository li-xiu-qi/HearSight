# 消息列表排版设计说明

## 概述

消息列表组件 (`MessageList.tsx`) 负责显示问答对话中的所有消息，包括用户消息和 AI 回复。该组件采用现代化的聊天界面设计，注重可读性和交互性。

## 整体布局

- **容器结构**: 使用 `ScrollArea` 实现可滚动区域，防止消息过多时界面溢出
- **消息排列**: 消息按时间顺序垂直排列，每个消息占一行
- **响应式设计**: 支持不同屏幕尺寸的自适应布局

## 消息样式设计

### 用户消息

- **位置**: 右侧对齐 (`justify-end`)
- **背景**: 蓝色渐变背景 (`bg-blue-500 text-white`)
- **圆角**: 标准圆角设计
- **内容**: 直接显示用户输入的文本

### AI 消息

- **位置**: 左侧对齐 (`justify-start`)
- **背景**: 浅灰色背景 (`bg-slate-100 text-slate-900`)
- **圆角**: 标准圆角设计
- **内容**: 智能解析并渲染，包括文本、时间戳链接和缩略图

## 时间戳处理

### 解析规则

- **单视频格式**: `[开始时间-结束时间]` (如 `[92000.00-113620.00]`)
- **多视频格式**: `[视频名 开始时间-结束时间]` (如 `[example.mp4 92000.00-113620.00]`)
- **正则表达式**: `/(\[.*?\s*\d+(?:\.\d+)?-\d+(?:\.\d+)?\])/g`

### 显示设计

- **换行显示**: 时间戳部分单独占一行，不与文本挤压
- **垂直布局**: 缩略图在上，时间戳按钮在下
- **样式**: 蓝色链接样式，hover 效果
- **时间格式**: 转换为可读的时间格式显示

## 缩略图显示

### 触发条件

- 仅在 `imageModeEnabled` 为 `true` 时显示
- 自动从后端获取对应时间的视频截图

### 布局设计

- **位置**: 位于时间戳上方
- **尺寸**: 最大宽度 320px，高度 96px (h-24)
- **样式**: 圆角边框，hover 透明度变化
- **加载状态**: 显示加载动画直到图片加载完成
- **点击交互**: 点击打开大图预览对话框

### 缓存机制

- 使用时间戳作为缓存键: `${startTimeSec}-${endTimeSec}`
- 避免重复加载相同时间的缩略图

## 复制功能

### 按钮设计

- **位置**: 每条消息右上角
- **样式**: 幽灵按钮样式，hover 显示
- **图标**: 使用 Copy 图标
- **反馈**: 成功复制时显示 toast 提示

## 响应式适配

- **移动端**: 消息宽度自适应，缩略图最大宽度调整
- **桌面端**: 保持固定最大宽度，优化阅读体验

## 交互设计

- **时间戳点击**: 跳转到对应视频时间点
- **多视频支持**: 自动识别视频名并切换到对应视频
- **图片预览**: 点击缩略图打开模态对话框
- **加载状态**: 显示加载动画，提升用户体验

## 性能优化

- **虚拟滚动**: 使用 ScrollArea 优化大量消息的渲染性能
- **图片懒加载**: 仅在需要时加载缩略图
- **缓存策略**: 本地缓存已加载的缩略图，避免重复请求

## 无障碍设计

- **语义化标签**: 使用适当的 ARIA 标签
- **键盘导航**: 支持键盘操作时间戳链接
- **屏幕阅读器**: 提供描述性文本和标签
